type User 
    @model 
    @auth(rules: [{ allow: owner, operations: [create, read, update, delete] }])
{
    id: ID! @primaryKey
    email: String!
    name: String
    age: Int
    gender: String
    experience: String
    profilePicture: String
    workoutDays: [UserWorkoutDay] @hasMany(indexName: "byUser", fields: ["id"])
    chatsInitiated: [Chat] @hasMany(indexName: "byUser1", fields: ["id"])
    chatsReceived: [Chat] @hasMany(indexName: "byUser2", fields: ["id"])
}

type WorkoutDay 
    @model 
    @auth(rules: [{ allow: owner, operations: [create, read, update, delete] }])
{
    id: ID! @primaryKey
    dayName: String!
    users: [UserWorkoutDay] @hasMany(indexName: "byWorkoutDay", fields: ["id"])
}

type UserWorkoutDay 
    @model 
    @auth(rules: [{ allow: owner, operations: [create, read, update, delete] }])
    @index(name: "byUser", sortKeyFields: ["workoutDayId"])
    @index(name: "byWorkoutDay", sortKeyFields: ["userId"])
{
    id: ID! @primaryKey
    userId: ID!
    workoutDayId: ID!
    user: User @belongsTo(fields: ["userId"])
    workoutDay: WorkoutDay @belongsTo(fields: ["workoutDayId"])
}

type Chat 
    @model 
    @auth(rules: [{ allow: owner, operations: [create, read, update, delete] }])
    @index(name: "byUser1", sortKeyFields: ["user2Id"])
{
    id: ID! @primaryKey
    user1Id: ID!
    user2Id: ID!
    user1: User @belongsTo(fields: ["user1Id"])
    user2: User @belongsTo(fields: ["user2Id"])
    messages: [Message] @hasMany(indexName: "byChat", fields: ["id"])
}

type Message 
    @model 
    @auth(rules: [{ allow: owner, operations: [create, read, update, delete] }])
    @index(name: "byChat", sortKeyFields: ["chatId"])
{
    id: ID! @primaryKey
    chatId: ID!
    senderId: ID!
    content: String
    timestamp: AWSDateTime!
    chat: Chat @belongsTo(fields: ["chatId"])
}
